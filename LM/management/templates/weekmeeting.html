{% extends "base.html" %}
{% load staticfiles %}
{% block title %}各个部门周列会推进表{% endblock %}

{% block content %}

<div class="container">
	<div class="row">
		<div class="col-md-12">
			{% if status == 'success' %}
				<div class="well">
					<h2 class="text-success text-center">周总结&计划添加成功！</h2>
				</div>
			{% elif status == 're_err' %}
				<div class="well">
					<h2 class="text-warning text-center">请重新提交</h2>
				</div>
			{% endif %}
			<form method="POST" role="form" class="form-horizontal">
				{% csrf_token %}
				<h1 class="form-signin-heading text-center">部门工作推进表</h1>
                <br /><br /><br />

				<div class="form-group">
					<label for="id_user_name" class="col-md-1 control-label">部门：</label>
					<div class="col-md-2">
						<input type="text" class="form-control" name="department" id="id_department" value="{{ user.partment }}" autofocus>
					</div>
                    <label for="id_user_name" class="col-md-1 control-label">姓名：</label>
					<div class="col-md-2">
						<input type="text" class="form-control"  value="{{ user.menber_name  }}">
					</div>
                    <label for="id_week" class="col-md-2 control-label">第几周：</label>
					<div class="col-md-2">
					    <select class="form-control" name="week" id="id_week" >
                            <option value="0" selected>请选择第几周</option>
                            <option value="第一周">第一周</option>
                            <option value="第二周">第二周</option>
                            <option value="第三周">第三周</option>
                            <option value="第四周">第四周</option>
                        </select>
					</div>
                    <div class="col-md-2">
                    <button class="btn btn-success" type="button" id="btn1">添加总结</button>
                    </div>
				</div>

                 <div class="form-group" id="after">


					<label for="id_evaluate" class="col-md-5 col-md-offset-1 control-label">上周工作内容:</label>

                    <label for="id_last_exeperson" class="col-md-2 control-label">执行人：</label>

                     <label for="id_last_comletiontime" class="col-md-2 control-label">完成时间：</label>

                     <label for="id_passwd" class="col-md-2 control-label">完成效果：</label>

				</div>

				 <div class="form-group" id="txt1">
					<div class="col-md-5 col-md-offset-1" >
						<textarea rows="3" cols="12" placeholder="善于总结经验，发现问题，提出建议，提高业务水平" class="form-control input-sm" id="id_lastweek" required name="lastweek" autofocus></textarea>
					</div>
					<div class="col-md-2">
						<input type="text" class="form-control" required name="last_exeperson" value="{{ user.menber_name  }}" id="id_last_exeperson">
					</div>
					<div class="col-md-2">
						<input type="date" class="form-control" required name="last_comletiontime" id="id_last_comletiontime">
					</div>
                    <div class="col-md-2">
					    <select class="form-control" name="comletioneffect" id="id_comletioneffect" >
                            <option value="0" selected>请选择完成效果</option>
                            <option value="已完成">已完成</option>
                            <option value="未完成">未完成</option>
                            <option value="延续性">延续性</option>
                        </select>
					</div>
				</div>

                <div class="form-group" id="txt1">
					<label for="id_last_exeperson" class="col-md-2 control-label">执行人：</label>
					<div class="col-md-2">
						<input type="text" class="form-control" required name="last_exeperson" value="{{ user.menber_name  }}" id="id_last_exeperson">
					</div>
                    <label for="id_last_comletiontime" class="col-md-2 control-label">完成时间：</label>
					<div class="col-md-2">
						<input type="date" class="form-control" required name="last_comletiontime" id="id_last_comletiontime">
					</div>
                     <label for="id_passwd" class="col-md-2 control-label">完成效果：</label>
                    <div class="col-md-2">
					    <select class="form-control" name="comletioneffect" id="id_comletioneffect" >
                            <option value="0" selected>请选择完成效果</option>
                            <option value="已完成">已完成</option>
                            <option value="未完成">未完成</option>
                            <option value="延续性">延续性</option>
                        </select>
					</div>
				</div>

                 <div class="form-group">
					<label for="id_evaluate" class="col-md-2 control-label">本周工作内容:</label>
					<div class="col-md-10">
						<textarea rows="8" cols="20" placeholder="凡事预则立不预则废" class="form-control input-sm" id="id_nextweek" required name="nextweek" autofocus></textarea>

					</div>
				</div>

                <div class="form-group">
                    <label for="id_next_exeperson" class="col-md-3 control-label">执行人：</label>
                    <div class="col-md-2">
						<input type="text" class="form-control" required name="next_exeperson" value="{{ user.menber_name  }}" id="id_next_exeperson">
					</div>
                      <label for="id_next_comletiontime" class="col-md-2 control-label">完成时间：</label>
					<div class="col-md-2">
						<input type="date" class="form-control" required name="next_comletiontime" id="id_next_comletiontime">
					</div>

				</div>


				<div class="form-group">
					<div class="col-md-4 col-md-offset-4">
						<button class="btn btn btn-primary btn-block" type="submit" id="id_submit">提交</button>
					</div>
				</div>

			</form>
		</div>
	</div>
</div>

<script type="text/javascript">
 <script>
 8    $(document).ready(function(){
 9        //<tr/>居中
10        $("#tab tr").attr("align","center");
11
12        //增加<tr/>
13        $("#but").click(function(){
14            var _len = $("#tab tr").length;
15            $("#tab").append("<tr id="+_len+" align='center'>"
16                                +"<td>"+_len+"</td>"
17                                +"<td>Dynamic TR"+_len+"</td>"
18                                +"<td><input type='text' name='desc"+_len+"' id='desc"+_len+"' /></td>"
19                                +"<td><a href=\'#\' onclick=\'deltr("+_len+")\'>删除</a></td>"
20                            +"</tr>");
21        })
22    })
23
24    //删除<tr/>
25    var deltr =function(index)
26    {
27        var _len = $("#tab tr").length;
28        $("tr[id='"+index+"']").remove();//删除当前行
29        for(var i=index+1,j=_len;i<j;i++)
30        {
31            var nextTxtVal = $("#desc"+i).val();
32            $("tr[id=\'"+i+"\']")
33                .replaceWith("<tr id="+(i-1)+" align='center'>"
34                                +"<td>"+(i-1)+"</td>"
35                                +"<td>Dynamic TR"+(i-1)+"</td>"
36                                +"<td><input type='text' name='desc"+(i-1)+"' value='"+nextTxtVal+"' id='desc"+(i-1)+"'/></td>"
37                                +"<td><a href=\'#\' onclick=\'deltr("+(i-1)+")\'>删除</a></td>"
38                            +"</tr>");
39        }
40
41    }
42</script>
</script>
<table id="tab" border="1" width="60%" align="center" style="margin-top:20px">
47        <tr>
48            <td width="20%">序号</td>
49            <td>标题</td>
50            <td>描述</td>
51            <td>操作</td>
52       </tr>
53    </table>
54    <div style="border:2px;
55                border-color:#00CC00;
56                margin-left:20%;
57                margin-top:20px">
58        <input type="button" id="but" value="增加"/>
59    </div>
{% endblock %}